#
# Syd Salmon's zsh configuration: functions
#
## run Brewster function at startup?
function brewsterf() {
  if read -qr "CHOICE?Press [y]es to run Brewster:  "; then
    printf "\033c\n==> running Brewster...\n\n"
    brewster
    return 0
  else
    return 1
  fi
}

## cd++ changes to new directory then prints 10 most recent files
function cl() {
  DIR="$*"
  if [[ $# -lt 1 ]]; then
    DIR=$PWD # if no DIR given, assume $PWD (current working directory)
  fi
  builtin cd "${DIR}" &&
    ls -aFGhort                               # sort by date, descending
  printf "\033c\n"                            # clear screen, insert newline
  lsd | grep --invert-match "dr.*" | tail -10 # print 10 most recent files
}

## colourize manpages
function colour-manpages() {
  LESS_TERMCAP_mb=$'\e[01;31m' \
    LESS_TERMCAP_md=$'\e[01;31m' \
    LESS_TERMCAP_me=$'\e[0m' \
    LESS_TERMCAP_se=$'\e[0m' \
    LESS_TERMCAP_so=$'\e[01;44;37m' \
    LESS_TERMCAP_ue=$'\e[0m' \
    LESS_TERMCAP_us=$'\e[01;32m' \
    command man "$@"
}

## global alias expansion
function globalias() {
  if [[ $LBUFFER =~ ' [A-Z0-9]+$' ]]; then
    zle _expand_alias
    zle expand-word
  fi
  zle self-insert
}

## start https-server
function https-server() {
  http-server --ssl --cert ~/.localhost-ssl/localhost.crt --key ~/.localhost-ssl/localhost.key
}
