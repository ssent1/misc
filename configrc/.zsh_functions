#!/bin/bash
# Syd Salmon's zsh configuration: functions

## run Brewster at startup
brewsterf() {
  if read -qr "CHOICE?Press [y]es to run Brewster:  "; then
    sleep 1
    spinner() {
      slt=0.67
      printf "\033c\r${(%):-%F{green}==<${(%):-%f} running Brewster${(%):-%F{green}.  ${(%):-%f}\n"
      sleep $slt
      printf "\033c\r${(%):-%F{green}==/${(%):-%f} running Brewster${(%):-%F{green}.. ${(%):-%f}\n"
      sleep $slt
      printf "\033c\r${(%):-%F{green}==>${(%):-%f} running Brewster${(%):-%F{green}...${(%):-%f}\n"
      sleep $slt
    }
    i=0
    while [ $i -le 3 ]; do
      spinner
      i=$(($i + 1))
    done
    brewster
    return 0
  else
    return 1
  fi
}

## cd++ changes to new directory then prints 10 most recent files
cl() {
  DIR="$*"
  if [ $# -lt 1 ]; then
        DIR=$PWD # if no DIR given, assume $PWD (current working directory)
      fi
  builtin cd "${DIR}" &&
    ls -aFGhort    # sort by date, descending
  printf "\033c\n" # clear screen, insert newline
  lsd|grep  --color=never --invert-match "dr.*" | tail -10
}

## global alias expansion
globalias() {
   if [[ $LBUFFER =~ ' [A-Z0-9]+$' ]]; then
     zle _expand_alias
     zle expand-word
   fi
   zle self-insert
}
zle -N globalias

## yank to system clipboard
vi-yank-xclip() {
    zle vi-yank
   echo "$CUTBUFFER"|pbcopy -i
}
zle -N vi-yank-xclip
